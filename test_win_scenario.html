<!DOCTYPE html>
<html>
<head>
    <title>Win Detection Test - Row Win</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .board { display: grid; grid-template-columns: repeat(3, 60px); gap: 5px; margin: 20px 0; }
        .cell { width: 60px; height: 60px; border: 2px solid #333; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; cursor: pointer; }
        .cell.x { color: #ff4444; }
        .cell.o { color: #4444ff; }
        .cell.winning { background-color: #ffff00; }
        .cell:hover:not(.x):not(.o) { background-color: #f0f0f0; }
        .status { margin: 20px 0; font-size: 18px; }
        .test-info { background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>Win Detection Test - Row Win Scenario</h1>
    
    <div class="test-info">
        <h3>Test Instructions:</h3>
        <p>Click on positions 0, 1, and 2 (top row) to create an X win. The cells should turn yellow when the win is detected.</p>
        <p><strong>Expected:</strong> When you place X in positions 0, 1, and 2, the game should detect a win and highlight those cells in yellow.</p>
    </div>
    
    <div class="status" id="status">Click on positions 0, 1, and 2 to test row win</div>
    <div class="board" id="board"></div>

    <script>
        // Game state
        let gameState = {
            board: ["", "", "", "", "", "", "", "", ""],
            currentPlayer: "X",
            isGameOver: false,
            winningLine: [],
            winner: null
        };

        // Check for winner (exact copy from server)
        function check_winner(board) {
            // Check rows
            for (let i = 0; i < 9; i += 3) {
                if (board[i] !== "" && board[i] === board[i+1] && board[i] === board[i+2]) {
                    return { winner: board[i], line: [i, i+1, i+2] };
                }
            }
            
            // Check columns
            for (let i = 0; i < 3; i++) {
                if (board[i] !== "" && board[i] === board[i+3] && board[i] === board[i+6]) {
                    return { winner: board[i], line: [i, i+3, i+6] };
                }
            }
            
            // Check diagonals
            if (board[0] !== "" && board[0] === board[4] && board[0] === board[8]) {
                return { winner: board[0], line: [0, 4, 8] };
            }
            if (board[2] !== "" && board[2] === board[4] && board[2] === board[6]) {
                return { winner: board[2], line: [2, 4, 6] };
            }
            
            // Check for draw
            let is_draw = true;
            for (let i = 0; i < 9; i++) {
                if (board[i] === "") {
                    is_draw = false;
                    break;
                }
            }
            
            if (is_draw) {
                return { winner: "draw", line: [] };
            }
            
            return { winner: null, line: [] };
        }

        // Render board
        function renderBoard() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';
            
            gameState.board.forEach((cell, index) => {
                const cellEl = document.createElement('div');
                cellEl.className = 'cell';
                cellEl.textContent = cell;
                
                if (cell === 'X') cellEl.classList.add('x');
                if (cell === 'O') cellEl.classList.add('o');
                if (gameState.winningLine.includes(index)) cellEl.classList.add('winning');
                
                if (!gameState.isGameOver && cell === "") {
                    cellEl.addEventListener('click', () => makeMove(index));
                }
                
                boardEl.appendChild(cellEl);
            });
        }

        // Make move
        function makeMove(index) {
            if (gameState.isGameOver || gameState.board[index] !== "") {
                return;
            }
            
            gameState.board[index] = gameState.currentPlayer;
            
            // Check for win
            const result = check_winner(gameState.board);
            if (result.winner) {
                gameState.isGameOver = true;
                gameState.winner = result.winner;
                gameState.winningLine = result.line;
                
                if (result.winner === 'draw') {
                    document.getElementById('status').textContent = "Game Over: It's a draw!";
                } else {
                    document.getElementById('status').textContent = `Game Over: ${result.winner} wins! Winning line: [${result.line.join(', ')}]`;
                }
            } else {
                gameState.currentPlayer = gameState.currentPlayer === 'X' ? 'O' : 'X';
                document.getElementById('status').textContent = `Current player: ${gameState.currentPlayer}`;
            }
            
            renderBoard();
        }

        // Initialize
        renderBoard();
    </script>
</body>
</html>